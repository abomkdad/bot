<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAD PARFUMEUR | Luxury Hub</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;800&family=Tajawal:wght@300;500;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-deep: #050505;        
            --card-surface: rgba(25, 25, 25, 0.75);   
            --gold-primary: #D4AF37;    
            --gold-light: #F3E5AB;      
            --text-main: #FFFFFF;
            --text-secondary: #AAAAAA;
            --accent-blue: #33ccff;
            --accent-whatsapp: #25D366;
            --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Cairo', 'Tajawal', sans-serif;
            background-color: var(--bg-deep);
            background-image: radial-gradient(circle at top, #1a1a1a 0%, #050505 60%);
            color: var(--text-main);
            direction: rtl;
            padding-bottom: 120px;
            min-height: 100vh;
        }

        header {
            padding: 40px 20px 20px;
            text-align: center;
        }

        .logo-img {
            max-width: 180px;
            height: auto;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 15px rgba(212, 175, 55, 0.3));
        }

        .slogan {
            font-size: 0.8rem;
            letter-spacing: 4px;
            color: var(--gold-primary);
            text-transform: uppercase;
            font-family: 'Playfair Display', serif;
        }

        /* --- Navigation Tabs --- */
        .hub-nav {
            display: flex;
            max-width: 500px;
            margin: 20px auto 30px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 100px;
            padding: 5px;
            position: sticky;
            top: 20px;
            z-index: 1000;
            backdrop-filter: blur(15px);
        }

        .nav-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 100px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: var(--transition);
            color: var(--text-secondary);
        }

        .nav-tab.active {
            background: var(--gold-primary);
            color: #000;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        /* --- Controls --- */
        .controls-wrapper {
            max-width: 550px;
            margin: 0 auto 30px;
            padding: 0 20px;
        }

        .lang-switch {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .lang-btn {
            background: transparent;
            border: 1px solid rgba(212, 175, 55, 0.2);
            color: var(--text-secondary);
            padding: 6px 20px;
            border-radius: 50px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .lang-btn.active { border-color: var(--gold-primary); color: var(--gold-primary); }

        .search-container { position: relative; }
        .search-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 15px;
            padding: 15px 45px 15px 20px;
            color: white;
            font-family: inherit;
            outline: none;
        }
        .search-input:focus { border-color: var(--gold-primary); }
        .search-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--gold-primary); }

        /* --- Containers --- */
        .container { max-width: 550px; margin: 0 auto; padding: 0 20px; }
        .view { display: none; }
        .view.active { display: block; animation: fadeIn 0.5s ease forwards; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Branch Card --- */
        .branch-card {
            background: var(--card-surface);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 22px;
            margin-bottom: 20px;
            transition: var(--transition);
        }
        .branch-card:hover { border-color: var(--gold-primary); transform: translateY(-3px); }
        .branch-name { font-size: 1.3rem; font-weight: 800; color: #fff; margin-bottom: 12px; }
        .hours-box {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
            border-right: 3px solid var(--gold-primary);
        }

        .actions-stack { display: flex; flex-direction: column; gap: 10px; }
        .actions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        .btn-action {
            padding: 14px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            font-size: 0.85rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: var(--transition);
        }
        .btn-waze { background: rgba(51, 204, 255, 0.1); color: var(--accent-blue); border: 1px solid rgba(51, 204, 255, 0.2); }
        .btn-call { background: var(--gold-primary); color: #000; }
        .btn-wa-branch { background: rgba(37, 211, 102, 0.1); color: var(--accent-whatsapp); border: 1px solid rgba(37, 211, 102, 0.3); width: 100%; }

        /* --- Product Card --- */
        .category-header { font-size: 1.1rem; color: #fff; margin: 35px 0 15px; font-weight: 800; padding-right: 15px; border-right: 4px solid var(--gold-primary); }

        .product-card {
            background: linear-gradient(145deg, rgba(35,35,35,0.8), rgba(15,15,15,0.9));
            border: 1px solid rgba(212, 175, 55, 0.1);
            border-radius: 24px;
            padding: 15px;
            margin-bottom: 18px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .product-img-wrapper {
            width: 85px; height: 110px; background: #000; border-radius: 12px; overflow: hidden; flex-shrink: 0; border: 1px solid rgba(255,255,255,0.05);
        }
        .product-img { width: 100%; height: 100%; object-fit: contain; }

        .product-info { flex: 1; }
        .product-code { font-size: 0.7rem; color: var(--gold-primary); font-weight: 800; text-transform: uppercase; margin-bottom: 2px; }
        .product-name { font-size: 1rem; font-weight: 800; color: #fff; margin-bottom: 6px; }
        .product-price { font-weight: 900; color: var(--gold-primary); font-size: 1.1rem; margin-bottom: 10px; display: block; }
        
        .buy-actions { display: flex; flex-direction: column; gap: 8px; }
        .btn-buy-sm { padding: 10px; background: var(--gold-primary); color: #000; border-radius: 8px; text-decoration: none; font-size: 0.75rem; font-weight: 700; text-align: center; }
        .btn-check-stock { 
            padding: 8px; background: rgba(37, 211, 102, 0.1); color: var(--accent-whatsapp); border-radius: 8px; text-decoration: none; font-size: 0.7rem; font-weight: 700; text-align: center;
            border: 1px solid rgba(37, 211, 102, 0.2); display: flex; align-items: center; justify-content: center; gap: 5px; cursor: pointer;
        }

        /* --- Modal System --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
            display: none; z-index: 3000; align-items: center; justify-content: center; padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal-card {
            background: #121212; border: 1px solid var(--gold-primary); border-radius: 24px; width: 100%; max-width: 450px;
            max-height: 80vh; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,1);
        }
        .modal-header { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); text-align: center; position: relative; }
        .modal-title { color: var(--gold-primary); font-weight: 800; font-size: 1.1rem; }
        .modal-close { position: absolute; left: 20px; top: 20px; color: #fff; font-size: 1.2rem; cursor: pointer; }
        .branch-selection-list { flex: 1; overflow-y: auto; padding: 10px 20px 20px; }
        .branch-select-item {
            display: flex; justify-content: space-between; align-items: center; padding: 16px; border-radius: 12px;
            background: rgba(255,255,255,0.03); margin-bottom: 10px; text-decoration: none; transition: var(--transition); border: 1px solid transparent;
        }
        .branch-select-item:hover { background: rgba(212, 175, 55, 0.1); border-color: var(--gold-primary); }
        .branch-select-name { color: #fff; font-weight: 600; font-size: 0.95rem; }
        .branch-select-icon { color: var(--accent-whatsapp); font-size: 1.2rem; }

        /* --- Footer --- */
        footer { text-align: center; padding: 40px 20px; color: #444; font-size: 0.7rem; letter-spacing: 2px; }

        .hotline-sticky {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 480px;
            background: rgba(10,10,10,0.95); backdrop-filter: blur(15px); border: 1px solid var(--gold-primary);
            padding: 14px 25px; border-radius: 100px; display: flex; justify-content: space-between; align-items: center;
            z-index: 2000; text-decoration: none; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }
        .hotline-icon { background: var(--gold-primary); color: #000; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <!-- Modal Selection -->
    <div class="modal-overlay" id="branchModal">
        <div class="modal-card">
            <div class="modal-header">
                <span class="modal-close" onclick="closeModal()">‚úï</span>
                <div class="modal-title" id="modalTitle">ÿßÿÆÿ™ÿ± ÿßŸÑŸÅÿ±ÿπ ŸÑŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±</div>
            </div>
            <div class="branch-selection-list" id="modalBranchList">
                <!-- Branches dynamically populated here -->
            </div>
        </div>
    </div>

    <header>
        <img src="https://abomkdad.github.io/Digital-Business-Card/logo.png" alt="MAD PARFUMEUR" class="logo-img">
        <div class="slogan" id="sloganText">Luxury Niche Perfumes</div>
    </header>

    <div class="hub-nav">
        <div class="nav-tab active" onclick="showView('branches')" id="tabBranches">ÿßŸÑŸÅÿ±Ÿàÿπ</div>
        <div class="nav-tab" onclick="showView('shop')" id="tabShop">ÿ™ÿ≥ŸàŸÇ ÿ£ŸàŸÜŸÑÿßŸäŸÜ</div>
    </div>

    <div class="controls-wrapper">
        <div class="lang-switch">
            <button class="lang-btn active" id="btnAr" onclick="switchLang('ar')">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
            <button class="lang-btn" id="btnHe" onclick="switchLang('he')">◊¢◊ë◊®◊ô◊™</button>
        </div>
        <div class="search-container">
            <span class="search-icon">üîç</span>
            <input type="text" id="masterSearch" class="search-input" placeholder="ÿ®ÿ≠ÿ´..." oninput="filterHub()">
        </div>
    </div>

    <!-- View: Branches -->
    <div id="viewBranches" class="view active">
        <div class="container" id="branchesContent"></div>
    </div>

    <!-- View: Shop -->
    <div id="viewShop" class="view">
        <div class="container" id="shopContent"></div>
    </div>

    <footer>¬© 2026 MAD PARFUMEUR | LUXURY HUB</footer>

    <a href="tel:*9935" class="hotline-sticky">
        <div style="display: flex; align-items: center; gap: 12px;">
            <div class="hotline-icon">üìû</div>
            <span style="color:#fff; font-weight:800; font-size:0.95rem;" id="supportText">ÿÆÿØŸÖÿ© ÿßŸÑÿ≤ÿ®ÿßÿ¶ŸÜ</span>
        </div>
        <div style="color:var(--gold-primary); font-weight:900; font-size:1.2rem;">*9935</div>
    </a>

    <script>
        let currentLang = 'ar';
        let selectedProduct = null;

        const branchData = [
            { id: 12, nameAr: "ÿ≠ŸäŸÅÿß", nameHe: "◊ó◊ô◊§◊î", phone: "0506164130", directLink: "https://www.waze.com/ul?ll=32.794046,34.989571&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊î◊©◊ë◊ï◊¢: 10:00 - 22:00" },
            { id: 4, nameAr: "ÿ™ŸÑ ÿ£ÿ®Ÿäÿ® - ŸäÿßŸÅÿß", nameHe: "◊™◊ú ◊ê◊ë◊ô◊ë-◊ô◊§◊ï", phone: "0527035370", directLink: "https://ul.waze.com/ul?ll=32.055104,34.756394&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "ŸÉŸÑ ŸäŸàŸÖ: 10:00 - 22:00" },
            { id: 3, nameAr: "ÿßŸÑÿ±ŸÖŸÑŸá", nameHe: "◊®◊û◊ú◊î", phone: "0527035370", directLink: "https://www.waze.com/ul?ll=31.9260024,34.876361&navigate=yes", hoursAr: "ÿßŸÑÿ£ÿ≠ÿØ-ÿßŸÑÿÆŸÖŸäÿ≥: 09:00-21:00", hoursHe: "◊ê'-◊î': 09:00-21:00" },
            { id: 7, nameAr: "ŸáŸäÿ±ÿ™ÿ≥ŸäŸÑŸäÿß", nameHe: "◊î◊®◊¶◊ú◊ô◊î", phone: "0522438398", directLink: "https://waze.com/ul?q=Sokolov+14+Herzliya&navigate=yes", hoursAr: "ÿßŸÑÿ£ÿ≠ÿØ-ÿßŸÑÿÆŸÖŸäÿ≥: 10:00-20:00", hoursHe: "◊ê'-◊î': 10:00-20:00" },
            { id: 14, nameAr: "ÿßŸÑÿÆÿ∂Ÿäÿ±ÿ©", nameHe: "◊ó◊ì◊®◊î", phone: "0523953681", directLink: "https://www.waze.com/ul?ll=32.441724,34.895061&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊î◊©◊ë◊ï◊¢: 10:00 - 22:00" },
            { id: 24, nameAr: "Ÿäÿ±ŸÉÿß", nameHe: "◊ô◊®◊õ◊ê", phone: "0546842420", directLink: "https://www.waze.com/ul?ll=32.947444,35.174066&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊ô◊ï◊ù: 10:00 - 22:00" },
            { id: 21, nameAr: "ÿ∑ŸÖÿ±ÿ©", nameHe: "◊ò◊û◊®◊î", phone: "0505830733", directLink: "https://www.waze.com/ul?ll=32.857368,35.174507&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊ô◊ï◊ù: 10:00 - 22:00" },
            { id: 23, nameAr: "ÿ¨ÿØŸäÿØÿ© ÿßŸÑŸÖŸÉÿ±", nameHe: "◊í◊≥◊ì◊ô◊ì◊î ◊ê◊ú◊û◊õ◊®", phone: "0508683838", directLink: "https://www.waze.com/ul?ll=32.932397,35.157608&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 11:00 - 21:00", hoursHe: "ŸÉŸÑ ŸäŸàŸÖ: 11:00 - 21:00" },
            { id: 22, nameAr: "ÿ≥ÿÆŸÜŸäŸÜ", nameHe: "◊°◊ó◊†◊ôŸÜ", phone: "0525335571", directLink: "https://www.waze.com/ul?ll=32.862019,35.298237&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:30 - 22:30", hoursHe: "ŸÉŸÑ ŸäŸàŸÖ: 10:30 - 22:30" },
            { id: 2, nameAr: "ŸÉŸÅÿ± ŸÖŸÜÿØÿß", nameHe: "◊õ◊§◊® ◊û◊†◊ì◊ê", phone: "0505102019", directLink: "https://ul.waze.com/ul?ll=32.808944,35.261725&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊ô◊ï◊ù: 10:00 - 22:00" },
            { id: 1, nameAr: "ÿØÿßŸÑŸäÿ© ÿßŸÑŸÉÿ±ŸÖŸÑ", nameHe: "◊ì◊ú◊ô◊™ ◊ê◊ú ◊õÿ±◊û◊ú", phone: "0525592293", directLink: "https://waze.com/ul?q=Kiwi%20store%20Daliyat%20al-Karmel&navigate=yes", hoursAr: "ŸäŸàŸÖŸäÿßŸã: 10:00 - 22:00", hoursHe: "◊õ◊ú ◊ô◊ï◊ù: 10:00 - 22:00" }
        ];

        const rawProducts = [
            { code: "A115 GOLD", cat: "MEN", price: 120, img: "https://www.madperfume.ps/upload/09-2025/product/68d431f8b331b-450px.png", name: "A115 Gold Edition" },
            { code: "G103 XM", cat: "MEN", price: 150, img: "https://madperfume.co.il/upload/06-2025/product/684eadefbc37f.png", name: "G103 Extreme" },
            { code: "OMBRE", cat: "NISHE", price: 350, img: "https://www.madperfume.co.il/upload/06-2025/product/52-450px.png", name: "MAD Ombre" },
            { code: "NARCOTIC", cat: "NISHE", price: 350, img: "https://www.madperfume.ps/upload/06-2025/product/4%20(2)-450px.png", name: "Narcotic Intense" },
            { code: "DREAM BOUQUET", cat: "HOME", price: 45, img: "https://www.madperfume.ps/upload/04-2025/product/mad-dream-bouquet-250-ml-luks-oda-spre-3d8abc.webp", name: "Dream Bouquet" }
        ];

        const ui = {
            ar: {
                slogan: "ÿπÿ∑Ÿàÿ± ŸÜŸäÿ¥ ŸÅÿßÿÆÿ±ÿ©", search: "ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿØŸäŸÜÿ© ÿ£Ÿà ŸÖŸÜÿ™ÿ¨...", 
                waze: "ŸÖŸÑÿßÿ≠ÿ© WAZE", call: "ÿßÿ™ÿµÿßŸÑ", waBranch: "ÿßÿ∑ŸÑÿ® Ÿàÿßÿ≥ÿ™ŸÑŸÖ ŸÖŸÜ ÿßŸÑŸÅÿ±ÿπ",
                support: "ÿÆÿØŸÖÿ© ÿßŸÑÿ≤ÿ®ÿßÿ¶ŸÜ", buy: "ÿ¥ÿ±ÿßÿ° ÿßŸÑÿ¢ŸÜ", 
                checkStock: "ÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿ£ŸÇÿ±ÿ® ŸÅÿ±ÿπ",
                modalTitle: "ÿßÿÆÿ™ÿ± ÿßŸÑŸÅÿ±ÿπ ŸÑŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±",
                waMsg: "ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ŸáŸÑ Ÿäÿ™ŸàŸÅÿ± Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑÿØŸäŸÉŸÖ ŸÅŸä ÿßŸÑŸÅÿ±ÿπÿü\nÿßŸÑŸÖŸÜÿ™ÿ¨: ",
                cats: { MEN: "ÿπÿ∑Ÿàÿ± ÿ±ÿ¨ÿßŸÑŸäÿ©", WOMEN: "ÿπÿ∑Ÿàÿ± ŸÜÿ≥ÿßÿ¶Ÿäÿ©", NISHE: "ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑŸÜŸäÿ¥", HOME: "ŸÖÿπÿ∑ÿ±ÿßÿ™ ÿßŸÑŸÖŸÜÿ≤ŸÑ", HAIR: "ÿπÿ∑Ÿàÿ± ÿßŸÑÿ¥ÿπÿ±" }
            },
            he: {
                slogan: "◊ë◊©◊û◊ô ◊†◊ô◊©◊î Ÿä◊ï◊ß◊®◊™◊ô◊ô◊ù", search: "◊ó◊ô◊§◊ï◊© ◊¢◊ô◊® ◊ê◊ï ◊û◊ï◊¶◊®...", 
                waze: "◊†◊ô◊ï◊ï◊ò ◊ë-WAZE", call: "◊î◊™◊ß◊©◊®", waBranch: "◊î◊ñ◊û◊ü ◊ï◊ê◊°◊ï◊£ ◊û◊î◊°◊†◊ô◊£",
                support: "◊©◊ô◊®◊ï◊™ ◊ú◊ß◊ï◊ó◊ï◊™", buy: "◊ß◊†◊î ◊¢◊õ◊©◊ô◊ï",
                checkStock: "◊¶◊ï◊® ◊ß◊©◊® ◊¢◊ù ◊î◊°◊†◊ô◊£ ◊î◊ß◊®◊ï◊ë",
                modalTitle: "◊ë◊ó◊® ◊°◊†◊ô◊£ ◊ú◊ë◊ô◊®◊ï◊®",
                waMsg: "◊©◊ú◊ï◊ù, ◊î◊ê◊ù ◊î◊û◊ï◊¶◊® ◊î◊ñ◊î ◊ñ◊û◊ô◊ü ◊ë◊û◊ú◊ê◊ô ◊ë◊°◊†◊ô◊£?\n◊û◊ï◊¶◊®: ",
                cats: { MEN: "◊ë◊©◊û◊ô ◊í◊ë◊®◊ô◊ù", WOMEN: "◊ë◊©◊û◊ô ◊†◊©◊ô◊ù", NISHE: "◊ß◊ï◊ú◊ß◊¶◊ô◊ô◊™ ◊†◊ô◊©◊î", HOME: "◊û◊§◊ô◊¶◊ô ◊®◊ô◊ó ◊ú◊ë◊ô◊™", HAIR: "◊ë◊ï◊©◊ù ◊ú◊©◊ô◊¢◊®" }
            }
        };

        function showView(view) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('view' + view.charAt(0).toUpperCase() + view.slice(1)).classList.add('active');
            document.getElementById('tab' + view.charAt(0).toUpperCase() + view.slice(1)).classList.add('active');
        }

        function switchLang(lang) {
            currentLang = lang;
            document.getElementById('btnAr').classList.toggle('active', lang === 'ar');
            document.getElementById('btnHe').classList.toggle('active', lang === 'he');
            document.getElementById('sloganText').innerText = ui[lang].slogan;
            document.getElementById('masterSearch').placeholder = ui[lang].search;
            document.getElementById('supportText').innerText = ui[lang].support;
            document.getElementById('modalTitle').innerText = ui[lang].modalTitle;
            document.documentElement.lang = lang;
            renderHub();
        }

        function renderBranches() {
            const container = document.getElementById('branchesContent');
            const search = document.getElementById('masterSearch').value.toLowerCase();
            container.innerHTML = '';

            branchData.filter(b => (currentLang==='ar'?b.nameAr:b.nameHe).toLowerCase().includes(search)).forEach(b => {
                const name = currentLang==='ar'?b.nameAr:b.nameHe;
                const card = document.createElement('div');
                card.className = 'branch-card';
                card.innerHTML = `
                    <div class="branch-name">${name}</div>
                    <div class="hours-box">${currentLang==='ar'?b.hoursAr:b.hoursHe}</div>
                    <div class="actions-stack">
                        <div class="actions-grid">
                            <a href="${b.directLink}" target="_blank" class="btn-action btn-waze">üìç ${ui[currentLang].waze}</a>
                            <a href="tel:${b.phone}" class="btn-action btn-call">üìû ${ui[currentLang].call}</a>
                        </div>
                        <a href="https://wa.me/972${b.phone.substring(1)}?text=${encodeURIComponent('ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå ÿ£ÿ±ŸäÿØ ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ŸÖŸÜ ŸÅÿ±ÿπ ' + name)}" target="_blank" class="btn-action btn-wa-branch">
                            Ÿàÿßÿ™ÿ≥ÿßÿ® ÿßŸÑŸÅÿ±ÿπ
                        </a>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderShop() {
            const container = document.getElementById('shopContent');
            const search = document.getElementById('masterSearch').value.toLowerCase();
            container.innerHTML = '';

            const grouped = {};
            rawProducts.forEach(p => {
                if(p.name.toLowerCase().includes(search) || p.code.toLowerCase().includes(search)) {
                    if(!grouped[p.cat]) grouped[p.cat] = [];
                    grouped[p.cat].push(p);
                }
            });

            for(const cat in grouped) {
                const head = document.createElement('div');
                head.className = 'category-header';
                head.innerText = ui[currentLang].cats[cat] || cat;
                container.appendChild(head);

                grouped[cat].forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <div class="product-img-wrapper">
                            <img src="${p.img}" alt="${p.name}" class="product-img" onerror="this.src='https://placehold.co/85x110?text=MAD'">
                        </div>
                        <div class="product-info">
                            <div class="product-code">${p.code}</div>
                            <div class="product-name">${p.name}</div>
                            <span class="product-price">${p.price} ‚Ç™</span>
                            <div class="buy-actions">
                                <a href="https://madperfume.co.il/" target="_blank" class="btn-buy-sm">${ui[currentLang].buy}</a>
                                <div class="btn-check-stock" onclick="openBranchSelector('${p.name}', '${p.code}')">
                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.246 2.248 3.484 5.232 3.484 8.402-.003 6.557-5.338 11.892-11.893 11.892-1.997-.001-3.951-.5-5.688-1.448l-6.309 1.666zm6.29-4.143c1.589.943 3.133 1.417 4.77 1.418 5.4 0 9.794-4.394 9.797-9.793.001-2.615-1.02-5.074-2.871-6.928-1.851-1.854-4.312-2.873-6.927-2.873-5.401 0-9.794 4.393-9.797 9.793-.001 1.743.46 3.447 1.332 4.931l-.995 3.636 3.691-.984zm11.023-6.551c-.261-.131-1.543-.761-1.782-.848-.239-.087-.413-.131-.588.131-.174.261-.674.848-.826 1.022-.152.174-.304.196-.565.065-.261-.131-1.101-.405-2.098-1.293-.775-.692-1.3-1.547-1.452-1.808-.152-.261-.016-.402.115-.532.117-.118.261-.304.391-.457.131-.152.174-.261.261-.435.087-.174.043-.326-.022-.457-.065-.131-.588-1.413-.804-1.935-.211-.51-.424-.44-.588-.448-.152-.007-.326-.008-.5-.008s-.457.065-.696.326c-.239.261-.913.891-.913 2.174 0 1.283.935 2.522 1.065 2.7.131.174 1.839 2.809 4.456 3.935.622.268 1.107.428 1.485.548.624.199 1.192.171 1.64.104.5-.075 1.543-.631 1.761-1.24.217-.609.217-1.131.152-1.24-.065-.109-.239-.174-.5-.304z"/></svg>
                                    ${ui[currentLang].checkStock}
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }
        }

        function openBranchSelector(name, code) {
            selectedProduct = { name, code };
            const list = document.getElementById('modalBranchList');
            list.innerHTML = '';

            branchData.forEach(b => {
                const bName = currentLang === 'ar' ? b.nameAr : b.nameHe;
                const waText = ui[currentLang].waMsg + name + " [" + code + "]\nŸÅŸä ŸÅÿ±ÿπ: " + bName;
                const waLink = `https://wa.me/972${b.phone.substring(1)}?text=${encodeURIComponent(waText)}`;

                const item = document.createElement('a');
                item.href = waLink;
                item.target = "_blank";
                item.className = 'branch-select-item';
                item.innerHTML = `
                    <span class="branch-select-name">${bName}</span>
                    <span class="branch-select-icon">üí¨</span>
                `;
                item.onclick = closeModal;
                list.appendChild(item);
            });

            document.getElementById('branchModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('branchModal').classList.remove('active');
        }

        function filterHub() { renderHub(); }
        function renderHub() { renderBranches(); renderShop(); }

        switchLang('ar');
    </script>
</body>
</html>
